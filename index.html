<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>EasyUI Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" media="screen" href="css/themes/default/easyui.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/themes/icon.css" />
  <style>
    a {
      text-decoration: none;
    }
    /* 左侧导航栏icon */
    .icon_tree_0 {
      background: url('img/icon/basic.png') no-repeat;
    }

    .icon_tree_1 {
      background: url('img/icon/layout.png') no-repeat;
    }

    .icon_tree_2 {
      background: url('img/icon/menu.png') no-repeat;
    }

    .icon_tree_3 {
      background: url('img/icon/form.png') no-repeat;
    }

    .icon_tree_4 {
      background: url('img/icon/window.png') no-repeat;
    }

    .icon_tree_5 {
      background: url('img/icon/grid.png') no-repeat;
    }

    .icon_tree_child {
      background: url('img/icon/gears.png') no-repeat;
    }

    .tree {
      overflow: auto;
    }

    .red {
      color: red;
    }
    .s {
      color: salmon;
      font-size: 26px;
    }
  </style>
</head>

<body class="easyui-layout">
  <!-- EasyUI 左侧导航栏-->

  <div id="js_navigation" region="west" data-options="title: '插件', spilt: true" style="width: 250px;">
    <div id="js_accordion" data-options="border: false" class="easyui-accordion">
      <!-- 动态加载tree -->
      <ul id="js_tree" class="easyui-tree tree">
      </ul>
      <!-- 手动添加tree -->
      <!-- <ul id="js_tree_0" class="easyui-tree tree">
        <li>
          <span>Base</span>
          <ul>
            <li><span>parser</span></li>
            <li><span>easyloader</span></li>
            <li><span>draggable</span></li>
            <li><span>droppable</span></li>
            <li><span>resizeable</span></li>
            <li><span>pagination</span></li>
            <li><span>searchbox</span></li>
            <li><span>progressbar</span></li>
            <li><span>tooltip</span></li>
            <li><span>mobile</span></li>
          </ul>
        </li>
      </ul>

      <ul id="js_tree_1" class="easyui-tree tree">
        <li>
          <span>Layout</span>
          <ul>
            <li><span>panel</span></li>
            <li><span>tabs</span></li>
            <li><span>accordion</span></li>
            <li><span>layout</span></li>
          </ul>
        </li>
      </ul>

      <ul id="js_tree_2" class="easyui-tree tree">
        <li>
          <span>Menu and Button</span>
          <ul>
            <li><span>menu</span></li>
            <li><span>sidemenu</span></li>
            <li><span>linkbutton</span></li>
            <li><span>menubutton</span></li>
            <li><span>splitbutton</span></li>
            <li><span>switchbutton</span></li>
          </ul>
        </li>
      </ul>

      <ul id="js_tree_3" class="easyui-tree tree">
        <li>
          <span>form</span>
          <ul>
            <li><span>form</span></li>
            <li><span>validatebox</span></li>
            <li><span>textbox</span></li>
            <li><span>passwordbox</span></li>
            <li><span>maskedbox</span></li>
            <li><span>combo</span></li>
            <li><span>combobox</span></li>
            <li><span>comcotree</span></li>
            <li><span>combogrid</span></li>
            <li><span>comnotreegrid</span></li>
            <li><span>tagbox</span></li>
            <li><span>numberbox</span></li>
            <li><span>datebox</span></li>
            <li><span>datetimebox</span></li>
            <li><span>datetimespinner</span></li>
            <li><span>calendar</span></li>
            <li><span>spinner</span></li>
            <li><span>numberspinner</span></li>
            <li><span>timespinner</span></li>
            <li><span>slider</span></li>
            <li><span>filebox</span></li>
            <li><span>checkbox</span></li>
            <li><span>radionbutton</span></li>
          </ul>
        </li>
      </ul>

      <ul id="js_tree_4" class="easyui-tree tree">
        <li>
          <span>Window</span>
          <ul>
            <li><span>window</span></li>
            <li><span>dialog</span></li>
            <li><span>messager</span></li>
          </ul>
        </li>
      </ul>

      <ul id="js_tree_5" class="easyui-tree tree">
        <li>
          <span>DataGrid and Tree</span>
          <ul>
            <li><span>datagrid</span></li>
            <li><span>datalist</span></li>
            <li><span>propertygrid</span></li>
            <li><span>tree</span></li>
            <li><span>treegrid</span></li>
          </ul>
        </li>
      </ul> -->
      <!-- End 手动添加tree -->
    </div>
  </div>




  <div data-options="region:'north',title:'North Title',split:true" style="height:100px;">
  </div>
  <div data-options="region:'south',title:'South Title',split:true" style="height:100px;"></div>
  <div data-options="region:'east',title:'East',split:true" style="width:100px;"></div>
  <div data-options="region:'west',title:'West',split:true" style="width:100px;"></div>
  <div id="js_eui_r_center" data-options="region:'center',title:'欢迎使用EasyUI'" style="padding:5px;background:#eee;">
    <div class="easyui-tabs" id="js_eui_tabs" data-options="border: false">
      <!-- <div data-options="title: 'easyui-linkbutton', closable: true">
          <h3>easyui-linkbutton</h3>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-add'">添加</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-edit'">编辑</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-remove'">删除</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-save'">保存</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-ok'">确定</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-no'">否定</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-cancel'">取消</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-man'">用户</a>
          <a class="easyui-linkbutton" data-options="iconCls: 'icon-cut'">剪切</a>
      </div> -->
    </div>
    <div id="js_eui_dialogs" class="easyui-dialog" data-options="
    title: 'dialog title',
    width: 400,
    height: 200,
    resizeable: true,
    closed: true,
    buttons: '#bb'">
      <form id="ff" method="post">
        <div>
          <label for="name">Name:</label>
          <input class="easyui-validatebox" type="text" name="name" data-options="required:true" />
        </div>
        <div>
          <label for="email">Email:</label>
          <input class="easyui-validatebox" type="text" name="email" data-options="validType:'email'" />
        </div>
      </form>

      <!-- 组合框 combobox 二级联动?-->
      <div style="margin-top: 15px;">
        <input id="js_eui_combobox" name="dept" value="choose one value" style="width: 200px; height: 30px;">
        <input id="js_eui_combobox_sec" name="sec" value="second value" style="width: 200px; height: 30px;">
      </div>

      <!-- 搜索框 -->
      <div style="margin-top: 10px;">
        <input id="js_eui_searchbox">
        <div id="js_eui_searchbox_menu" style="width: 120px;">
          <div data-options="name: 'all', iconCls: 'icon-ok'">ok</div>
          <div data-options="name: 'sports'">sports</div>
        </div>
      </div>


    </div>
    <!-- 按钮组 -->
    <div id="bb">
      <a href="#" class="easyui-linkbutton" onclick="dia_save()">Save</a>
      <a href="#" class="easyui-linkbutton">Close</a>
    </div>




    <table id="js_eui_datagrid" class="easyui-datagrid">
    </table>
  </div>


  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.easyui.min.js"></script>
  <script src="js/jquery.easyui.mobile.js"></script>
  <script src="js/easyloader.js"></script>
  <script type="text/javascript" src="js/plugins/datagrid-defaultview.js"></script>
  <script src="http://www.jeasyui.com/easyui/datagrid-detailview.js"></script>


  <script>
    /* datagrid 行内编辑 */
    $.extend($.fn.datagrid.methods, {
      editCell: function (jq, param) {
        return jq.each(function () {
          var opts = $(this).datagrid('options');
          var fields = $(this).datagrid('getColumnFields', true).concat($(this).datagrid('getColumnFields'));
          for (var i = 0; i < fields.length; i++) {
            var col = $(this).datagrid('getColumnOption', fields[i]);
            col.editor1 = col.editor;
            if (fields[i] != param.field) {
              col.editor = null;
            }
          }
          $(this).datagrid('beginEdit', param.index);
          var ed = $(this).datagrid('getEditor', param);
          if (ed) {
            if ($(ed.target).hasClass('textbox-f')) {
              $(ed.target).textbox('textbox').focus();
            } else {
              $(ed.target).focus();
            }
          }
          for (var i = 0; i < fields.length; i++) {
            var col = $(this).datagrid('getColumnOption', fields[i]);
            col.editor = col.editor1;
          }
        });
      }
    });

    var editIndex = undefined;

    function endEditing() {
      if (editIndex == undefined) {
        return true;
      }
      if ($('#js_eui_datagrid').datagrid('validateRow', editIndex)) {
        $('#js_eui_datagrid').datagrid('endEdit', editIndex);
        editIndex = undefined;
        return true;
      } else {
        return false;
      }
    }

    function onClickCell(index, field) {
      if (endEditing()) {
        $('#js_eui_datagrid').datagrid('selectRow', index)
          .datagrid('editCell', {
            index: index,
            field: field
          })
        editIndex = index;
      }
    }

    /* End datagrid 行内编辑 */

    // easyui插件配置属性
    $('#js_tree').tree({
      url: 'json/easyui-tree.json',
      method: 'get',
      animate: true,
      onClick: function (node) {
        var obj_tree_index = node.id;
        var obj_panel_title = '';
        var obj_panel_title_sub = node.text;
        // 获取父级tree标题
        var obj_tree_father = $(this).tree("getParent", node.target);
        obj_tree_father != null ? (obj_panel_title = obj_tree_father.text) : obj_panel_title_sub

        // 获取center区域的panel
        var obj_panel = $('body').layout('panel', 'center');
        obj_panel.panel('setTitle', obj_panel_title + '>>' + obj_panel_title_sub);

        var url = 'tab_' + node.id + '.html';
        // center区域内容: 动态生成tabs node.attributes.url
        addTabs(node.text, url);
      }
    });

    function addTabs(text, url) {
      if ($('#js_eui_tabs').tabs('exists', text)) {
        $('#js_eui_tabs').tabs('select', text)
      } else {
        var content = "<iframe frameborder='0' scrolling='auto' style='width:100%;height:100%' src=" +
          url + "></iframe>";
        $('#js_eui_tabs').tabs('add', {
          title: text,
          closable: true,
          content: content
        })
      }
    }

    $('#js_eui_datagrid').datagrid({
      title: 'easyui-datagrid',
      border: false,
      method: 'get',
      url: 'json/easyui-datagrid.json',
      columns: [
        [{
            // 选择框
            field: 'ck',
            checkbox: true
          },
          {
            field: 'code',
            title: 'Code',
            width: '20%',
            sortable: true,
            formatter: formatCode, // 符合条件 样式等修改
            // editor: 'text' // 行内编辑
          },
          {
            field: 'name',
            title: 'Name',
            width: '20%',
            sortable: true,
            editor: 'text'
          },
          {
            field: 'price',
            title: 'Price',
            width: '20%',
            sortable: true,
            editor: 'text'
          },
          {
            field: 'rest',
            title: 'Rest',
            width: '20%',
            sortable: true,
            editor: 'numberbox'
          },
          {
            field: '_operate',
            width: '20%',
            formatter: formatterFun,
            title: '操作'
          }
        ]
      ],
      rownumbers: true,
      pagination: true,
      singleSelect: true,
      // checkOnSelect: true,
      // multiSort: true,
      sortable: true,
      remoteSort: false, // 是否允许从服务器排序
      toolbar: [{
          'iconCls': 'icon-remove',
          handler: function () {
            /* datagrid获取选中单行的数据 getSelected
                       获取所有选中行的数据 getEslections
             */
            var obj_rowdataCode = [];
            var obj_rowdata = $('#js_eui_datagrid').datagrid('getSelections');
            if (obj_rowdata) {
              for (var i = 0; i < obj_rowdata.length; i++) {
                obj_rowdataCode.push(obj_rowdata[i].code);
              }
              console.log(obj_rowdataCode);
            } else {
              console.log('null')
            }
          }
        }, '-',
        {
          'iconCls': 'icon-add',
          handler: function () {
            alert("add-dosome code here");
          }
        }
      ],
      // 设置符合条件的行数据样式等
      rowStyler: function (index, row) {
        if (row.rest == '200') {
          return 'background-color: #6293bb; color: #fff; font-wight: bold;';
        }
      },
      // 添加自定义方法, 继承$.fn.datagrid.methods
      onClickCell: onClickCell,

      view: detailview,
      detailFormatter: function (index, row) {
        // return '<div class="ddv" style="padding: 5px 0;"><table id="ddv-' + index + '"></table></div>';
        return '<div class="ddv" style="padding: 5px 0;"><table class="easyui-datagrid" id="js_eui_th-datagrid-' +
          index + '"></table></div>';
      },
      // 多级grid数据
      onExpandRow: onExpandRow,


    });
    //数据发生变化时执行刷新 $('#js_eui_datagrid').datagrid('reload');

    // 符合条件 行样式等修改
    function formatCode(val, row) {
      if (val == 'C_1') {
        return '<span style="color: red;">' + val + '</span>';
      } else {
        return val;
      }
    }
    // 多级grid数据 function
    function onExpandRow(index, row) {
      $('#js_eui_th-datagrid-' + index).datagrid({
        url: 'json/easyui-second-datagrid.json',
        method: 'get',
        fitColumns: true,
        singleSelect: false,
        height: 'auto',
        columns: [
          [{
              "field": "th-code",
              "title": "Th-Code"
            },
            {
              "field": "th-rest",
              "title": "Th-Rest"
            },
            {
              "field": "th-price",
              "title": "Th-Price"
            }
          ]
        ],
        /* onExpandRow: function (index, row) {
          var ddv = $(this).datagrid('getRowDetail', index).find('table .div');
        }, */
        onLoad: function () {
          $('#js_eui_datagrid').datagrid('fixDetailRowHeight', index);
          $('#js_eui_datagrid').datagrid('selectRow', index);
          $('#js_eui_datagrid').datagrid('getRowDetail', index).find('form').form('load', row);
          $('#js_eui_datagrid').datagrid('fixDetailRowHeight', index);
          $('#js_eui_datagrid').datagrid('fixRowHeight', index);
        },
        onResize: function () {
          $('#js_eui_datagrid').datagrid('fixDetailRowHeight', index);
        },
        onLoadSuccess: function () {
          $('#js_eui_datagrid').datagrid('fixDetailRowHeight', index);
          setTimeout(function () {
            var tr = $('#js_eui_th-datagrid-' + index).closest('tr');
            var id = tr.prev().attr('id');
            id = id.replace(/-2-(\d+)$/, '-1-$1');
            $('#' + id).next().css('height', tr.height());
          }, 0);
        }
      });
      $('#js_eui_datagrid').datagrid('fixDetailRowHeight', index);
    }

    // 在列表右侧添加 按钮
    function formatterFun(value, row, index) {
      return [
        '<a href="javascript:;" onclick="showUpdate(' + index + ')">',
        '<img src="icons/edit_add.png"/>',
        '添加<span>&nbsp;&nbsp;</span></a>',
        '<a href="javascript:;" onclick="addCompatible(' + row.rest + ')">修改</a>' + '<span>&nbsp;&nbsp;</span>',
        '<a href="javascript:;" onclick="destory(' + row.rest + ')">刪除</a>' + '<span>&nbsp;&nbsp;</span>'
      ].join("&nbsp;");;
    }

    function showUpdate(index) {
      // console.log('update: ' + index);
      $("#js_eui_dialogs").dialog("open");
    }

    function addCompatible(index) {
      alert('addCompatible: ' + index);
    }

    function destory(indexs) {
      alert('destory: ' + indexs);
    }

    /* 弹窗 */
    // $('#js_eui_dialog').dialog('refresh', 'new_content.php');
    function dia_save() {
      var obj_v_combobox = $('#js_eui_combobox').combobox('getText');
      // $('#js_eui_combobox').combobox('getValue');
      console.log(obj_v_combobox);
    }

    /* 组合框 commobox */
    $('#js_eui_combobox').combobox({
      url: 'json/combobox_data1.json',
      method: 'get',
      valueField: 'id',
      textField: 'text',
      onSelect: function (rec) {
        var url = 'json/combobox_data2.json';
        // $('#js_eui_combobox_sec').combobox('reload', url);
        $('#js_eui_combobox_sec').combobox({
          url: url,
          method: 'get',
          valueField: 'id',
          textField: 'desc'
        }).combobox('clear');
        var value = $(this).combobox('getValue');
        $('#js_eui_combobox_sec').combobox('select', value);
      },
      onLoadSuccess: function () {
        /* var value = $(this).combobox('getValue');
        $('#js_eui_combobox_sec').combobox('select', value); */
      }
    });

    /* 搜索框 searchbox */
    $('#js_eui_searchbox').searchbox({
      searcher: function (val, name) {
        alert(val + ',' + name);
      },
      menu: '#js_eui_searchbox_menu',
      prompt: 'please input value'
    });









    /* 手动添加tree，修改样式图标
    var js_tree_count = 5;
    for (var js_tree_index = 0; js_tree_index <= js_tree_count; js_tree_index++) {
      $('#js_tree_' + js_tree_index).tree({
        onLoadSuccess: function (node, data) {
          $('#js_tree_' + js_tree_index).find('li').eq(0).find('.tree-icon').eq(0).addClass('icon_tree_' +
            js_tree_index);
          $('#js_tree_' + js_tree_index).find('ul').eq(0).find('li .tree-icon').addClass('icon_tree_child');
        },
        onClick: function (node) {
          $("#js_eui_tabs").tabs('add', {
            title: 'add tabs by jq',
            border: false,
            content: 'this tab has been added by jquery',
            closable: true,
            tools: [{
            }],
            onSelect: function () {
              // alert(this.title + 'is selected');
            }
          });
        }
      });
    } */
  </script>
</body>

</html>